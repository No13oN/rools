# Універсальний синтез документації: що лишити, що об’єднати, що конвертувати

## Мета
Стандартизувати набір архітектурних документів так, щоб:
- не було дублікатів;
- не було суперечливих правил;
- усе було в Markdown;
- існував єдиний порядок дій для `діючого середовища` і для `нового середовища`.

## Що лишити (цільовий мінімум)
Залишити 3 канонічні документи:
1. `ARCHITECTURE.md` — фінальна цільова архітектура і принципи.
2. `MIGRATION_RUNBOOK.md` — покрокова міграція з контрольними точками.
3. `AGENT_RULES.md` — обов’язкові правила роботи агентів (system prompt addendum).

Додатково за потреби:
1. `ADR_INDEX.md` — реєстр ключових рішень.
2. `CHANGELOG_ARCH.md` — історія змін архітектурних правил.

## Що об’єднати
Об’єднувати за смислом, а не за назвою файлу.

1. Усі файли типу `Architecture Plan` + `Architecture Critique`:
- звести в один `ARCHITECTURE.md`;
- структура: `Проблеми -> Принципи -> Цільова модель -> Обмеження -> KPI`;
- якщо є конфлікт між версіями, пріоритет має новіша, більш безпечна й масштабована модель.

2. Усі файли типу `Migration Checklist` + фрагменти міграції з інших документів:
- звести в один `MIGRATION_RUNBOOK.md`;
- структура: `Підготовка -> Мапінг -> Міграція -> Валідація -> Rollback`.

3. Правила для агентів із різних джерел:
- звести в `AGENT_RULES.md`;
- прибрати дублікати директив;
- явно зафіксувати заборонені дії (перезапис shared-файлів, робота із секретами, неконтрольовані зміни в базі знань).

## Що конвертувати
1. Усі `.docx` -> `.md` (UTF-8):
- конвертувати в чистий Markdown;
- прибрати артефакти форматування (зламані таблиці, переноси, службові символи);
- нормалізувати заголовки `H1/H2/H3`.

2. Файли, які виглядають як `.py`, але фактично є JSON notebook-експортом:
- або конвертувати в реальні виконувані `.py`;
- або перейменувати/зберігати як `.ipynb`;
- у документації фіксувати тільки одну канонічну форму.

3. Дублі з суфіксами `(1)`, `(2)`:
- прибрати з робочого набору;
- лишити лише канонічний файл + архівну копію за потреби.

## Послідовність: сценарій 1 (діючий проєкт)
1. Інвентаризація:
- список файлів;
- хеші файлів;
- текстові хеші після конвертації `.docx -> .txt` для пошуку семантичних дублікатів.

2. Вибір канону:
- для кожного типу документа обрати `одне джерело істини`;
- зафіксувати рішення в короткому ADR.

3. Конвертація:
- конвертувати всі `.docx` у `.md`;
- перевірити структуру заголовків і таблиць;
- виправити поламані блоки форматування.

4. Злиття:
- сформувати `ARCHITECTURE.md`, `MIGRATION_RUNBOOK.md`, `AGENT_RULES.md`;
- винести суперечливі моменти в секцію `Open Issues` до фінального узгодження.

5. Валідація:
- перевірка на дублікати змісту;
- перевірка на суперечності між `ARCHITECTURE.md` і `AGENT_RULES.md`;
- dry-run міграційного сценарію за `MIGRATION_RUNBOOK.md`.

6. Архівація:
- перенести застарілі/дубльовані матеріали в `archive/docs_legacy/`;
- не видаляти одразу без контрольного періоду.

## Послідовність: сценарій 2 (новий проєкт)
1. Стартовий пакет:
- одразу створити лише 3 файли: `ARCHITECTURE.md`, `MIGRATION_RUNBOOK.md`, `AGENT_RULES.md`.

2. Правила версіонування:
- один документ одного типу;
- оновлення через PR/рев’ю;
- заборона створення файлів-клонів із суфіксами `(1)`, `(2)`.

3. Шаблони:
- для кожного документа завести шаблон розділів;
- заповнення йде лише за шаблоном, без довільної структури.

4. Контроль якості:
- перед кожним релізом: перевірка узгодженості правил агентів із архітектурою;
- раз на цикл: ревізія розділу `KPI` і `Rollback`.

5. Міграція в майбутньому:
- нові ідеї спочатку в ADR;
- після прийняття ADR — апдейт канонічного документа;
- заборона паралельних «чернеток-двійників».

## Правило пріоритетів при конфліктах
1. Безпека і цілісність даних.
2. Масштабованість і відсутність конфліктів запису.
3. Простота виконання агентами.
4. Зручність для людини-оператора.

## Definition of Done
Робота вважається завершеною, коли:
1. Є рівно один канонічний документ кожного типу.
2. Усі робочі документи в Markdown.
3. Немає дублюючих версій із суфіксами `(1)/(2)` у робочому контурі.
4. Є перевірений порядок дій для `діючого` і `нового` сценарію.
